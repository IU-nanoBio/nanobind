# 3D simulation of ligand and P22 binding to T-cells

units lj
boundary f p p
atom_style bond
neighbor        0.3     bin
neigh_modify    every   1       delay   0       check   yes

## Create Simulation Box, Atoms ##
read_data       possibleP22CD40L

## Group Atoms by Type ##
group   vlp       type    1
group   ligand    type    2

## Defining Particle/Medium Properties ##
mass    1       590               # reduced mass of vlp P22
mass    2       1           # reduced mass of ligand
mass    3       1               # mass of wall, irrelevant
#set     group vlp diameter 1.62
#set     group ligand diameter 0.1
#set 	 group wall diameter 0.2

## Ascribing Initial Velocities ##
velocity        all     create  1.0     4928459 rot     yes     dist    gaussian        units   box     # 1-kB*T,random seed,zero net ang.mom.,gauss from MB stats75

## Fixing Wall particles ##
fix xwalls all wall/reflect xhi EDGE xlo EDGE

## Ascribing interparticle potentials: ##

pair_style      hybrid lj/expand        2.5     lj/cut 2.5
pair_coeff      1       1       lj/cut           1      1.62     1.8183       # epsilon, sigma, cut-off  V-V
pair_coeff      1       2       lj/expand        1      0.12     0.74   0.97  # epsilon, sigma_hc, delta_V-L, cut-off
pair_coeff      2       2       lj/cut           1      0.1      0.1122       # L-L
pair_coeff      1       3       lj/expand        1      0.12     0.79   1.02  # V-W
pair_coeff      2       3       lj/expand        5      0.12     0.03   0.17  # L-W
pair_coeff      3       3       lj/cut           0      0.2                   # W-W

#pair_modify  shift   yes     # the additive e_LJ for repulsion-only


## Making bonds ##
bond_style harmonic
bond_coeff 1    1000.0  0.809   # type, K, distance
bond_coeff 2    1000.0  0.270
bond_coeff 3    1000.0  0.500

## Ensemble Fixes (+ for output) ##
variable        myTStep equal   0.001 # timestep where 1 MD step is 752.72 ps
timestep        ${myTStep}
variable        myDStep equal   1000

fix     ens     vlp     nvt     temp    1.      1.      0.1
fix     ens2    ligand  nvt     temp    1.      1.      0.1  # T_start, T_stop, T_damp=100*timestep
fix_modify ens energy yes  # adds thermostat energy to potential
fix_modify ens2 energy yes

## Initial Image Dump ##
dump mymovie all custom 100 ovitomovie.melt id type x y z

print "OUTPUT COLUMNS: SIMULATION STEP NUMBER | TEMPERATURE | NP POTENTIAL ENERGY | SYSTEM VOLUME"

thermo_style   custom  step    temp   etotal  ke      pe     #print info to file
thermo  50000

#restart 500000  outfiles/assemblyRestart.*      # creates 5 restart files up to equilibration; can comment this
run     1500000

## Defining Output Information ##
dump    posD    all     custom  ${myDStep}      outfiles/dump.melt      id      type    x       y       z       # c_atomPot     c_atomKin

#restart 500000  outfiles/assemblyRestart.*      # creates 5 restart files post equilibration; keep this
#run     1500000

unfix   ens
unfix   ens2
undump  posD
undump mymovie
#shell          echo "Lammps Simulation Ended"

